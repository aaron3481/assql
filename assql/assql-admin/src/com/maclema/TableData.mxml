<?xml version="1.0" encoding="utf-8"?>
<mx:Canvas xmlns:mx="http://www.adobe.com/2006/mxml" creationComplete="onCreationComplete()">
	<mx:Script>
		<![CDATA[
			import com.maclema.util.ResultsUtil;
			import com.maclema.mysql.Field;
			import mx.controls.dataGridClasses.DataGridColumn;
			import com.maclema.mysql.events.MySqlEvent;
			import com.maclema.mysql.Statement;
			import com.maclema.mysql.Connection;
			
			public var con:Connection;
			
			private var _tableName:String = null;
			
			private function onCreationComplete():void {
				refresh();
			}
			
			public function set tableName(value:String):void {
				this._tableName = value;
				refresh();	
			}
			
			public function get tableName():String {
				return _tableName;
			}
			
			private function refresh():void {
				if ( con && grid ) {
					var st:Statement = con.createStatement();
					st.addEventListener(MySqlEvent.RESULT, handleResult);
					st.executeQuery("select * from " + tableName);
				}
			}
			
			private function handleResult(e:MySqlEvent):void {
				grid.columns = ResultsUtil.getDataGridColumns(e.resultSet);
				grid.dataProvider = e.resultSet.getRows();
			}
		]]>
	</mx:Script>
	<mx:DataGrid id="grid" height="100%" width="100%" variableRowHeight="true">
	</mx:DataGrid>
</mx:Canvas>